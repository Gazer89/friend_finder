<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Friend Finder</title>
  <!-- Latest compiled and minified CSS & JS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

</head>
<body>
    <div class="container">
        <div class="jumbotron">
            <h1>Friend Finder</h1>
            <h3>Tell us a little about yourself and we will find you the friend with the greatest compatibilty!</h3>
            <hr>
            <a href="/home"><button class="btn"><span class="glyphicon glyphicon-home"></span></button></a>
        </div>

        <div class="row">
            <div class="col-xs-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                    <h3 class="panel-title"><strong>About You</strong></h3>
                    </div>

                    <div class="panel-body">
                        <form>
                            <div class="form-group row">
                                <div class="col-xs-4">
                                    <label for="name">Name</label>
                                    <input type="text" class="form-control" id="name" placeholder="Enter name">
                                </div>
                                <div class="col-xs-4">
                                    <label for="InputEmail1">Email address</label>
                                    <input type="email" class="form-control" id="InputEmail1" aria-describedby="emailHelp" placeholder="Enter email">
                                    <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
                                </div>
                                <div class="col-xs-4">
                                    <label for="picture">Picture URL</label>
                                    <input type="text" class="form-control" id="picture" placeholder="Enter URL for your picture">
                                </div>
                            </div> 

                            <h3>
                                Please rate all of the following statements based on your feelings about the statement.
                            </h3>

                            <div class="form-group row">
                                <div class="col-xs-4">
                                    <label for="q1">
                                        You consider yourself an active person.
                                    </label>
                                    <div class="row">
                                        <select id="q1"class="custom-select" style="margin-left: 20px;">
                                            <option selected>Select an option</option>
                                            <option value="1">1 (Strongly Disagree)</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5 (Strongly Agree)</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-4">
                                    <label for="q2">
                                        You consider yourself a gamer.
                                    </label>
                                    <div class="row">
                                        <select id="q2"class="custom-select" style="margin-left: 20px;">
                                            <option selected>Select an option</option>
                                            <option value="1">1 (Strongly Disagree)</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5 (Strongly Agree)</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-4">
                                    <label for="q3">
                                        Beer is the best beverage on earth.
                                    </label>
                                    <div class="row">
                                        <select id="q3" class="custom-select" style="margin-left: 20px;">
                                            <option selected>Select an option</option>
                                            <option value="1">1 (Strongly Disagree)</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5 (Strongly Agree)</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group row">
                                <div class="col-xs-4">
                                    <label for="q4">
                                        Sports are awesome.
                                    </label>
                                    <div class="row">
                                        <select id="q4" class="custom-select"style="margin-left: 20px;">
                                            <option selected>Select an option</option>
                                            <option value="1">1 (Strongly Disagree)</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5 (Strongly Agree)</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-4">
                                    <label for="q5">
                                        Camping is amazing.
                                    </label>
                                    <div class="row">
                                        <select id="q5" class="custom-select" style="margin-left: 20px;">
                                            <option selected>Select an option</option>
                                            <option value="1">1 (Strongly Disagree)</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5 (Strongly Agree)</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-4">
                                    <label for="q6">
                                        Watching TV is the best activity.
                                    </label>
                                    <div class="row">
                                        <select id="q6" class="custom-select" style="margin-left: 20px;">
                                            <option selected>Select an option</option>
                                            <option value="1">1 (Strongly Disagree)</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5 (Strongly Agree)</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group row">
                                <div class="col-xs-4">
                                    <label for="q7">
                                        Your favorite color is blue.
                                    </label>
                                    <div class="row">
                                        <select id="q7" class="custom-select" style="margin-left: 20px;">
                                            <option selected>Select an option</option>
                                            <option value="1">1 (Strongly Disagree)</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5 (Strongly Agree)</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-4">
                                    <label for="q8">
                                        Starwars is the best movie series ever.
                                    </label>
                                    <div class="row">
                                        <select id="q8" class="custom-select" style="margin-left: 20px;">
                                            <option selected>Select an option</option>
                                            <option value="1">1 (Strongly Disagree)</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5 (Strongly Agree)</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-4">
                                    <label for="q9">
                                        Pizza can be eatten for every meal.
                                    </label>
                                    <div class="row">
                                        <select id="q9" class="custom-select" style="margin-left: 20px;">
                                            <option selected>Select an option</option>
                                            <option value="1">1 (Strongly Disagree)</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5 (Strongly Agree)</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-xs-4">
                                    <label for="q10">
                                        Icecream is the best dessert ever.
                                    </label>
                                    <div class="row">
                                        <select id="q10" class="custom-select" style="margin-left: 20px;">
                                            <option selected>Select an option</option>
                                            <option value="1">1 (Strongly Disagree)</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5 (Strongly Agree)</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-4">
                                    <label for="q11">
                                        Art is an importamt form of expression.
                                    </label>
                                    <div class="row">
                                        <select id="q11" class="custom-select" style="margin-left: 20px;">
                                            <option selected>Select an option</option>
                                            <option value="1">1 (Strongly Disagree)</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5 (Strongly Agree)</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-4">
                                    <label for="q12">
                                        Salad is rabbit food.
                                    </label>
                                    <div class="row">
                                        <select id="q12" class="custom-select" style="margin-left: 20px;">
                                            <option selected>Select an option</option>
                                            <option value="1">1 (Strongly Disagree)</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5 (Strongly Agree)</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </form>
                        <a href=""><button id="finishSurvey" class="btn btn-danger btn-lg " data-toggle='modal' data-target='#myModal'>Submit</button></a>
                    </div>
                </div>
            </div>
        </div>

        <hr>
        <footer class="footer">
          <div class="container">
            <p><a href="/api/friends">API Friends List</a> | <a href="https://github.com/Gazer89/friend_finder">GitHub Repo</a></p>
          </div>
        </footer>

    </div>
    <div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
        
            <!-- Modal content-->
            <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Modal Header</h4>
            </div>
            <div class="modal-body">
                <div id="myfriend"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
            </div>
        
        </div>
    </div>
            
    <script type="text/javascript">src="server.js"</script>
    <script type="text/javascript">src="friends.js"</script>

    <script>
        var friendMatch = {
            name: "",
            diff: 100,
            image:""
        }   
        var newUser;
        var scores;
        var sum;

   $("#finishSurvey").on("click", function(event) {
        event.preventDefault();
            scores= [
                parseInt($("#q1").val()),
                parseInt($("#q2").val()),
                parseInt($("#q3").val()),
                parseInt($("#q4").val()),
                parseInt($("#q5").val()),
                parseInt($("#q6").val()),
                parseInt($("#q7").val()),
                parseInt($("#q8").val()),
                parseInt($("#q9").val()),
                parseInt($("#q10").val()),
                parseInt($("#q11").val()),
                parseInt($("#q12").val())
            ];

            newUser = {
            name: $("#name").val().trim(),
            email: $("#InputEmail1").val().trim(),
            picture: $("#picture").val().trim(),
            scores: scores
            };

            friendMatchs(scores)

            $.post("/api/userList", newUser),(function(data) {
                // console.log(data);
                alert("Submission compelet, click on view mataches!");
            });
          
    });
    

    function friendMatchs (scores) {
        $.get('/api/friends', (friends) => {
            for (var i = 0; i < friends.length; i++) {
                console.log ("----------------------------")
                var diff =0;
                for (var x = 0; x < friends[i].scores.length; x++) {
                    console.log("newUser.scores[x]" + newUser.scores[x]);
                    console.log("friends[i].scores[x])" + friends[i].scores[x]);
                    diff += Math.abs(newUser.scores[x] - friends[i].scores[x]);
                    console.log("diff:" + diff);
                }
                    if (diff<friendMatch.diff) {
                        friendMatch.diff = diff;
                        friendMatch.name = friends[i].name;
                        friendMatch.image = friends[i].picture;
                    }
            }
            if (friends.length){
                console.log(friendMatch)
                var bestFriendImg = $("<img>").attr({src:friendMatch.image});
                $(bestFriendImg).append($("<div  style='fontsize: 50px'>").text("Your best friend is" + friendMatch.name1))
                $(bestFriendImg).css({hieght: "150px",width: "150px"})
                var bestFreindName = $("<tr>").html(friendMatch.name)
                var bestFriendScore =  $("<tr>").html(friendMatch.diff);
                $("#myfriend").append(bestFriendImg, bestFreindName, bestFriendScore);
            }	
        });	
    }
    </script>
    
</body>
</html>
    